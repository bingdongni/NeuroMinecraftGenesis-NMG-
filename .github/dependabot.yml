# Dependabotè‡ªåŠ¨ä¾èµ–æ›´æ–°é…ç½®
# åˆ›å»ºæ—¶é—´: 2025-11-14
# é¡¹ç›®: NeuroMinecraft Genesis v1.0.0+

version: 2

# Pythonä¾èµ–åŒ…æ›´æ–°é…ç½®
updates:
  # PythonåŒ…ä¾èµ–
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Asia/Shanghai"
    open-pull-requests-limit: 10
    reviewers:
      - "project-maintainer"  # è¯·æ›¿æ¢ä¸ºå®žé™…ç»´æŠ¤è€…ç”¨æˆ·å
    assignees:
      - "project-maintainer"  # è¯·æ›¿æ¢ä¸ºå®žé™…ç»´æŠ¤è€…ç”¨æˆ·å
    commit-message:
      prefix: "deps"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "automated"
    ignore:
      # å¿½ç•¥æŸäº›ä¸ç¨³å®šçš„åŒ…
      - dependency-name: "torch"
        update-types: ["version-update:semver-major"]
      - dependency-name: "tensorflow"
        update-types: ["version-update:semver-major"]
      # ä¿æŒä¸»è¦ç‰ˆæœ¬é”å®š
      - dependency-name: "*"
        update-types: ["version-update:semver-major"]

  # GitHub Actionsä¾èµ–æ›´æ–°
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "monthly"
      day: "first-monday"
      time: "10:00"
      timezone: "Asia/Shanghai"
    open-pull-requests-limit: 5
    reviewers:
      - "project-maintainer"  # è¯·æ›¿æ¢ä¸ºå®žé™…ç»´æŠ¤è€…ç”¨æˆ·å
    assignees:
      - "project-maintainer"  # è¯·æ›¿æ¢ä¸ºå®žé™…ç»´æŠ¤è€…ç”¨æˆ·å
    commit-message:
      prefix: "ci"
      include: "scope"
    labels:
      - "dependencies"
      - "github-actions"
      - "automated"

# å…·ä½“çš„åŒ…é…ç½®ï¼ˆå¯é€‰ï¼‰
# å¦‚æžœéœ€è¦ä¸ºç‰¹å®šåŒ…è®¾ç½®ä¸åŒè§„åˆ™
dependency-ecosystem:
  updates:
    # å®‰å…¨æ›´æ–°ä¼˜å…ˆçº§æ›´é«˜
    - package-ecosystem: "pip"
      directory: "/"
      schedule:
        interval: "daily"  # å®‰å…¨æ›´æ–°æ¯å¤©æ£€æŸ¥
      open-pull-requests-limit: 20
      labels:
        - "security"
        - "dependencies"
        - "automated"
      # åªå¤„ç†å®‰å…¨ç›¸å…³æ›´æ–°
      allow:
        - dependency-type: "direct"
          update-type: "security"
        - dependency-type: "indirect"
          update-type: "security"

# æ›´æ–°ç­–ç•¥é…ç½®
registries:
  # å¯ä»¥é…ç½®ç§æœ‰registryï¼ˆå¦‚æžœéœ€è¦ï¼‰
  # private-pypi:
  #   type: python-index
  #   url: https://private-pypi.example.com
  #   username: ${{secrets.PRIVATE_PYPI_USERNAME}}
  #   password: ${{secrets.PRIVATE_PYPI_PASSWORD}}
  #   primary: true

# ç‰ˆæœ¬çº¦æŸé…ç½®
version-strategy:
  # è‡ªåŠ¨åˆå¹¶å°ç‰ˆæœ¬å’Œè¡¥ä¸ç‰ˆæœ¬æ›´æ–°
  auto-merge-strategy:
    minor: "auto-merge"
    patch: "auto-merge"
  # ä¸»è¦ç‰ˆæœ¬æ›´æ–°éœ€è¦äººå·¥å®¡æ ¸
  major: "manual-review"

# PRæ¨¡æ¿é…ç½®
pull-request-templates:
  dependencies:
    title: "ðŸ¤– è‡ªåŠ¨ä¾èµ–æ›´æ–°: {dependency}"
    body: |
      ## ðŸ“¦ ä¾èµ–æ›´æ–°
      
      **åŒ…**: {dependency}  
      **ç‰ˆæœ¬**: {version} â†’ {new-version}  
      **ç±»åž‹**: {update-type}  
      **å®‰å…¨**: {vulnerability}  
      
      ### ðŸ“‹ å˜æ›´è¯¦æƒ…
      {body}
      
      ### ðŸ§ª æµ‹è¯•çŠ¶æ€
      - [ ] CI/CDæµ‹è¯•é€šè¿‡
      - [ ] åŠŸèƒ½æµ‹è¯•å®Œæˆ
      - [ ] å‘åŽå…¼å®¹æ€§éªŒè¯
      
      ### ðŸ“ æ£€æŸ¥æ¸…å•
      - [ ] é˜…è¯»æ›´æ–°æ—¥å¿—
      - [ ] æ£€æŸ¥Breaking Changes
      - [ ] æ›´æ–°ç›¸å…³æ–‡æ¡£
      - [ ] æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
      
      ---
      *æ­¤PRç”±Dependabotè‡ªåŠ¨ç”Ÿæˆ*
      
  github-actions:
    title: "ðŸ”„ GitHub Actionsæ›´æ–°: {dependency}"
    body: |
      ## ðŸ”§ Actionsæ›´æ–°
      
      **Actions**: {dependency}  
      **ç‰ˆæœ¬**: {version} â†’ {new-version}  
      
      ### ðŸ“‹ æ›´æ–°å†…å®¹
      {body}
      
      ### âœ… éªŒè¯æ£€æŸ¥
      - [ ] æµ‹è¯•å·¥ä½œæµæ­£å¸¸è¿è¡Œ
      - [ ] æ— æƒé™ç›¸å…³é—®é¢˜
      - [ ] å…¼å®¹æ€§æ£€æŸ¥é€šè¿‡
      
      ---
      *æ­¤PRç”±Dependabotè‡ªåŠ¨ç”Ÿæˆ*

# å®‰å…¨é…ç½®
security:
  # å®‰å…¨æ¼æ´žè­¦å‘Š
  vulnerability-alerts:
    enabled: true
    schedule:
      interval: "daily"
    labels:
      - "security"
      - "vulnerability"
    # ç«‹å³åˆ›å»ºPRå¤„ç†å®‰å…¨æ¼æ´ž
    open-pull-requests-limit: 50

  # è®¸å¯è¯æ£€æŸ¥
  license-checker:
    enabled: true
    schedule:
      interval: "weekly"
    labels:
      - "license"
      - "dependencies"
    # è®¸å¯è¯å˜æ›´éœ€è¦å®¡æ ¸
    require-human-review: true

# ç›‘æŽ§é…ç½®
monitoring:
  # å¤±è´¥é€šçŸ¥
  failure-notifications:
    enabled: true
    schedule:
      interval: "daily"
    channels:
      - "security"  # Slack/Teamsé¢‘é“
      
  # æ›´æ–°ç»Ÿè®¡
  update-statistics:
    enabled: true
    schedule:
      interval: "monthly"
    report-file: "dependabot-statistics.md"

# è‡ªå®šä¹‰è§„åˆ™
rules:
  # ç¦æ­¢çš„åŒ…åˆ—è¡¨
  blocked-packages:
    - "tensorflow-gpu"  # ä½¿ç”¨cpuç‰ˆæœ¬
    - "torch-cuda"      # ä½¿ç”¨cpuç‰ˆæœ¬
    # æ·»åŠ å…¶ä»–éœ€è¦é˜»æ­¢çš„åŒ…
    
  # å¿…é¡»é”å®šçš„åŒ…ç‰ˆæœ¬
  locked-versions:
    - package: "torch"
      version: ">=2.0.0,<3.0.0"
    - package: "numpy" 
      version: ">=1.21.0,<2.0.0"
    - package: "pandas"
      version: ">=1.5.0,<3.0.0"

# é«˜çº§é…ç½®ç¤ºä¾‹
advanced:
  # æŒ‰çŽ¯å¢ƒåˆ†ç»„
  environment-groups:
    production:
      packages:
        - "torch"
        - "tensorflow"
        - "numpy"
      update-strategy: "security-first"
    development:
      packages:
        - "pytest"
        - "black"
        - "flake8"
      update-strategy: "latest"
      
  # æŒ‰é£Žé™©çº§åˆ«åˆ†ç»„
  risk-groups:
    low-risk:
      packages:
        - "tqdm"
        - "colorama"
        - "click"
      auto-merge: true
    high-risk:
      packages:
        - "torch"
        - "tensorflow"
        - "numpy"
      auto-merge: false
      require-review: true

# é€šçŸ¥é…ç½®
notifications:
  # é‚®ä»¶é€šçŸ¥
  email:
    enabled: true
    addresses:
      - "maintainer@example.com"  # è¯·æ›¿æ¢ä¸ºå®žé™…é‚®ç®±
    frequency: "weekly"
    include:
      - "security-updates"
      - "major-updates"
      
  # Slacké€šçŸ¥ï¼ˆéœ€è¦webhookï¼‰
  slack:
    enabled: false  # è®¾ç½®ä¸ºtrueå¯ç”¨
    webhook: ${{ secrets.SLACK_WEBHOOK }}
    channels:
      - "dependencies"
    mention:
      - "project-maintainer"
      
  # GitHubé€šçŸ¥
  github:
    enabled: true
    reviewers:
      - "project-maintainer"
    assignees:
      - "project-maintainer"